#!/usr/bin/env node

var hosts2 = require('../lib/hosts2.js')
var cli = require('commander')

cli
    .version('0.0.5')
    .usage('[options] sub-command')
    // .option('-a --append', 'append mode')
    // .option('-o --overwrite', 'overwrite original hosts file')

cli
    .command('add <profile> [hostsStr]')
    .action(function(profile, hostsStr) {
        hosts2.add(profile, hostsStr)
        process.exit(0)
    })

cli
    .command('remove <profile>')
    .action(function(profile) {
        cli.confirm('delete this profile permanently? [y or n]: ', function(ok) {
            if (ok) {
                hosts2.remove(profile)
            } else {
                console.log('job canceled')
            }

            process.exit(0)
        })
    })

cli
    .command('on <profile>')
    .description('turn on the specific hosts profile')
    .action(function(profile) {
        hosts2.on(profile)
        process.exit(0)
    })

cli
    .command('reset')
    .description('clear the host records added by <hosts2>')
    .action(function() {
        hosts2.reset()
        process.exit(0)
    })

cli
    .command('*')
    .description('deploy the given env')
    .action(function(env){
        debug('deploying "%s"', env);
    });

cli.parse(process.argv)